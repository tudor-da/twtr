module Tests where
import Tweet
import User
 
import DA.Next.Set as Set
users_testa = scenario do
  alice <- getParty "alice"
  aliceU <- submit alice do create User with username = alice, reviewers = Set.empty
  
  bob <- getParty "bob"
  bobU <- submit bob do create User with username = bob, reviewers = Set.empty

  charlie <- getParty "charlie"
  charlieU <- submit charlie do create User with username = charlie, reviewers = Set.empty

  newAliceU <- submit alice (exercise aliceU (AddReviewer bob))
  newAlice <- submit alice (exercise newAliceU (AddReviewer charlie))

  t1 <- submit alice (exercise newAlice (PublishTweet "hi"))

  Left t2 <- submit bob (exercise t1 (TweetProposal_Sign bob))
  submitMustFail alice (exercise t2 Tweet_Release)

  submit charlie (exercise t2 (TweetProposal_Sign charlie))